import{_ as i,C as t,c as n,o as l,j as s,G as o,ag as r,a as h}from"./chunks/framework.Ds56KWXN.js";const E=JSON.parse('{"title":"Database Checks","description":"","frontmatter":{},"headers":[],"relativePath":"checks/database.md","filePath":"checks/database.md"}'),p={name:"checks/database.md"};function c(d,a,u,g,k,b){const e=t("CopyOrDownloadAsMarkdownButtons");return l(),n("div",null,[a[0]||(a[0]=s("div",{style:{display:"none"},hidden:"true","aria-hidden":"true"},"Are you an LLM? You can read better optimized documentation at /docs/checks/database.md for this page in Markdown format",-1)),a[1]||(a[1]=s("h1",{id:"database-checks",tabindex:"-1"},[h("Database Checks "),s("a",{class:"header-anchor",href:"#database-checks","aria-label":'Permalink to "Database Checks"'},"​")],-1)),o(e),a[2]||(a[2]=r(`<p>Database checks monitor your database health, table structure, character encoding, and query performance. Database issues can cause site errors or data corruption.</p><p><strong>Total checks in this category: 18</strong></p><h2 id="connection-server-4-checks" tabindex="-1">Connection &amp; Server (4 checks) <a class="header-anchor" href="#connection-server-4-checks" aria-label="Permalink to &quot;Connection &amp; Server (4 checks)&quot;">​</a></h2><h3 id="database-connection" tabindex="-1">Database Connection <a class="header-anchor" href="#database-connection" aria-label="Permalink to &quot;Database Connection&quot;">​</a></h3><p>Verifies database connectivity.</p><ul><li><strong>Good</strong>: Connection successful</li><li><strong>Critical</strong>: Connection failed</li></ul><p><strong>Why it matters</strong>: No database connection means your site is completely broken.</p><p><strong>Common causes</strong>:</p><ul><li>Incorrect database credentials</li><li>Database server down</li><li>Firewall blocking connection</li><li>Exceeded connection limits</li></ul><h3 id="database-server-version" tabindex="-1">Database Server Version <a class="header-anchor" href="#database-server-version" aria-label="Permalink to &quot;Database Server Version&quot;">​</a></h3><p>Checks database version compatibility.</p><ul><li><strong>Good</strong>: MySQL 8.0+ or MariaDB 10.4+</li><li><strong>Warning</strong>: Below recommended versions</li><li><strong>Critical</strong>: Below minimum supported versions</li></ul><p><strong>Why it matters</strong>: Older database versions lack security patches and performance improvements.</p><h3 id="database-user-privileges" tabindex="-1">Database User Privileges <a class="header-anchor" href="#database-user-privileges" aria-label="Permalink to &quot;Database User Privileges&quot;">​</a></h3><p>Verifies user has necessary permissions.</p><ul><li><strong>Good</strong>: All required privileges present</li><li><strong>Warning</strong>: Missing recommended privileges</li><li><strong>Critical</strong>: Missing essential privileges (SELECT, INSERT, UPDATE, DELETE)</li></ul><p><strong>Why it matters</strong>: Insufficient privileges prevent updates, backups, and normal operations.</p><p><strong>Required privileges</strong>:</p><ul><li>SELECT, INSERT, UPDATE, DELETE (essential)</li><li>CREATE, DROP, ALTER (for updates)</li><li>INDEX, CREATE TEMPORARY TABLES (for performance)</li></ul><h3 id="connection-charset" tabindex="-1">Connection Charset <a class="header-anchor" href="#connection-charset" aria-label="Permalink to &quot;Connection Charset&quot;">​</a></h3><p>Checks database connection character set.</p><ul><li><strong>Good</strong>: utf8mb4</li><li><strong>Warning</strong>: utf8</li><li><strong>Critical</strong>: Other charsets</li></ul><p><strong>Why it matters</strong>: utf8mb4 supports full Unicode including emojis and special characters.</p><h2 id="table-health-5-checks" tabindex="-1">Table Health (5 checks) <a class="header-anchor" href="#table-health-5-checks" aria-label="Permalink to &quot;Table Health (5 checks)&quot;">​</a></h2><h3 id="table-engine-consistency" tabindex="-1">Table Engine Consistency <a class="header-anchor" href="#table-engine-consistency" aria-label="Permalink to &quot;Table Engine Consistency&quot;">​</a></h3><p>Verifies all tables use InnoDB.</p><ul><li><strong>Good</strong>: All tables use InnoDB</li><li><strong>Warning</strong>: Some tables use MyISAM</li><li><strong>Critical</strong>: Core tables use MyISAM</li></ul><p><strong>Why it matters</strong>: InnoDB provides transactions, crash recovery, and better performance.</p><p><strong>How to fix</strong>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tablename ENGINE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">InnoDB;</span></span></code></pre></div><h3 id="table-charset-collation" tabindex="-1">Table Charset/Collation <a class="header-anchor" href="#table-charset-collation" aria-label="Permalink to &quot;Table Charset/Collation&quot;">​</a></h3><p>Checks table character encoding.</p><ul><li><strong>Good</strong>: All tables use utf8mb4_unicode_ci</li><li><strong>Warning</strong>: Some tables use utf8mb4_general_ci</li><li><strong>Critical</strong>: Tables using latin1 or other charsets</li></ul><p><strong>Why it matters</strong>: Consistent charset prevents data corruption and encoding issues.</p><h3 id="table-status" tabindex="-1">Table Status <a class="header-anchor" href="#table-status" aria-label="Permalink to &quot;Table Status&quot;">​</a></h3><p>Scans for corrupted tables.</p><ul><li><strong>Good</strong>: No corruption detected</li><li><strong>Critical</strong>: Corruption found</li></ul><p><strong>Why it matters</strong>: Corrupted tables cause errors, data loss, and site crashes.</p><p><strong>How to fix</strong>:</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">REPAIR </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tablename;</span></span></code></pre></div><p>Or use phpMyAdmin&#39;s repair function.</p><h3 id="auto-increment-headroom" tabindex="-1">Auto-increment Headroom <a class="header-anchor" href="#auto-increment-headroom" aria-label="Permalink to &quot;Auto-increment Headroom&quot;">​</a></h3><p>Checks if auto-increment values are approaching limits.</p><ul><li><strong>Good</strong>: Below 80% of maximum</li><li><strong>Warning</strong>: 80-95% of maximum</li><li><strong>Critical</strong>: Above 95% of maximum</li></ul><p><strong>Why it matters</strong>: Reaching the limit prevents new records from being created.</p><p><strong>How to fix</strong>:</p><ul><li>For INT columns: Change to BIGINT</li><li>Clean up old/unused records</li><li>Archive historical data</li></ul><h3 id="orphaned-tables-detection" tabindex="-1">Orphaned Tables Detection <a class="header-anchor" href="#orphaned-tables-detection" aria-label="Permalink to &quot;Orphaned Tables Detection&quot;">​</a></h3><p>Identifies tables not belonging to any extension.</p><ul><li><strong>Good</strong>: No orphaned tables</li><li><strong>Warning</strong>: Orphaned tables found</li></ul><p><strong>Why it matters</strong>: Orphaned tables waste space and may indicate incomplete uninstallations.</p><p><strong>How to handle</strong>:</p><ol><li>Identify which extension created them</li><li>If extension is uninstalled, safe to delete</li><li>Back up first before deleting</li><li>Use phpMyAdmin or SQL to drop tables</li></ol><h2 id="database-configuration-4-checks" tabindex="-1">Database Configuration (4 checks) <a class="header-anchor" href="#database-configuration-4-checks" aria-label="Permalink to &quot;Database Configuration (4 checks)&quot;">​</a></h2><h3 id="sql-mode-compatibility" tabindex="-1">SQL Mode Compatibility <a class="header-anchor" href="#sql-mode-compatibility" aria-label="Permalink to &quot;SQL Mode Compatibility&quot;">​</a></h3><p>Checks MySQL/MariaDB SQL mode settings.</p><ul><li><strong>Good</strong>: Compatible SQL mode</li><li><strong>Warning</strong>: Potentially problematic modes enabled</li></ul><p><strong>Why it matters</strong>: Strict SQL modes can break poorly-written extensions.</p><p><strong>Common issues</strong>:</p><ul><li><code>STRICT_TRANS_TABLES</code> - Rejects invalid data</li><li><code>ONLY_FULL_GROUP_BY</code> - Requires proper GROUP BY clauses</li><li><code>NO_ZERO_DATE</code> - Disallows &#39;0000-00-00&#39; dates</li></ul><h3 id="max-allowed-packet" tabindex="-1">Max Allowed Packet <a class="header-anchor" href="#max-allowed-packet" aria-label="Permalink to &quot;Max Allowed Packet&quot;">​</a></h3><p>Verifies maximum packet size.</p><ul><li><strong>Good</strong>: 16MB or higher</li><li><strong>Warning</strong>: 8-16MB</li><li><strong>Critical</strong>: Below 8MB</li></ul><p><strong>Why it matters</strong>: Small packet size prevents large INSERT/UPDATE queries.</p><p><strong>How to fix</strong>:</p><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[mysqld]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">max_allowed_packet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=32M</span></span></code></pre></div><h3 id="wait-timeout" tabindex="-1">Wait Timeout <a class="header-anchor" href="#wait-timeout" aria-label="Permalink to &quot;Wait Timeout&quot;">​</a></h3><p>Checks connection timeout setting.</p><ul><li><strong>Good</strong>: 300 seconds or more</li><li><strong>Warning</strong>: Below 300 seconds</li></ul><p><strong>Why it matters</strong>: Short timeouts cause &quot;MySQL server has gone away&quot; errors during long operations.</p><h3 id="table-prefix-set" tabindex="-1">Table Prefix Set <a class="header-anchor" href="#table-prefix-set" aria-label="Permalink to &quot;Table Prefix Set&quot;">​</a></h3><p>Verifies database table prefix is configured.</p><ul><li><strong>Good</strong>: Custom prefix (not <code>jos_</code>)</li><li><strong>Warning</strong>: Using default <code>jos_</code> prefix</li></ul><p><strong>Why it matters</strong>: Custom prefixes make SQL injection attacks harder.</p><h2 id="common-issues-solutions" tabindex="-1">Common Issues &amp; Solutions <a class="header-anchor" href="#common-issues-solutions" aria-label="Permalink to &quot;Common Issues &amp; Solutions&quot;">​</a></h2><h3 id="connection-failures" tabindex="-1">Connection Failures <a class="header-anchor" href="#connection-failures" aria-label="Permalink to &quot;Connection Failures&quot;">​</a></h3><p><strong>Symptoms</strong>: &quot;Error establishing database connection&quot;</p><p><strong>Solutions</strong>:</p><ol><li>Check <code>configuration.php</code> for correct credentials</li><li>Verify database server is running</li><li>Check firewall rules</li><li>Verify database user exists and has permissions</li><li>Check connection limits (<code>max_connections</code>)</li></ol><h3 id="character-encoding-issues" tabindex="-1">Character Encoding Issues <a class="header-anchor" href="#character-encoding-issues" aria-label="Permalink to &quot;Character Encoding Issues&quot;">​</a></h3><p><strong>Symptoms</strong>: Garbled text, question marks, broken emojis</p><p><strong>Solutions</strong>:</p><ol><li>Convert database to utf8mb4:<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> DATABASE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> dbname </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CHARACTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utf8mb4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COLLATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utf8mb4_unicode_ci;</span></span></code></pre></div></li><li>Convert tables to utf8mb4:<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">ALTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tablename CONVERT </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TO</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> CHARACTER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> SET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utf8mb4 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">COLLATE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> utf8mb4_unicode_ci;</span></span></code></pre></div></li><li>Update <code>configuration.php</code>:<div class="language-php vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">php</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $dbtype </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;mysqli&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">public</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $dbprefix </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;xyz_&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div></li></ol><h3 id="table-corruption" tabindex="-1">Table Corruption <a class="header-anchor" href="#table-corruption" aria-label="Permalink to &quot;Table Corruption&quot;">​</a></h3><p><strong>Symptoms</strong>: Database errors, missing data, crashes</p><p><strong>Solutions</strong>:</p><ol><li>Identify corrupted tables:<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CHECK</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tablename;</span></span></code></pre></div></li><li>Repair corrupted tables:<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">REPAIR </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tablename;</span></span></code></pre></div></li><li>If repair fails, restore from backup</li><li>Investigate cause (disk full, crashes, hardware issues)</li></ol><h3 id="performance-problems" tabindex="-1">Performance Problems <a class="header-anchor" href="#performance-problems" aria-label="Permalink to &quot;Performance Problems&quot;">​</a></h3><p><strong>Symptoms</strong>: Slow queries, timeouts</p><p><strong>Solutions</strong>:</p><ol><li>Optimize tables:<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OPTIMIZE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tablename;</span></span></code></pre></div></li><li>Add missing indexes (check slow query log)</li><li>Increase database server resources</li><li>Enable query cache (if available)</li><li>Consider read replicas for high traffic</li></ol><h3 id="orphaned-tables" tabindex="-1">Orphaned Tables <a class="header-anchor" href="#orphaned-tables" aria-label="Permalink to &quot;Orphaned Tables&quot;">​</a></h3><p><strong>Symptoms</strong>: Unknown tables in database</p><p><strong>Solutions</strong>:</p><ol><li>Identify table purpose:<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SHOW </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tablename;</span></span></code></pre></div></li><li>Search for extension that created it</li><li>Backup before deletion:<div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">mysqldump</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -u</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dbname</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tablename</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> backup.sql</span></span></code></pre></div></li><li>Drop if confirmed orphaned:<div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DROP</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tablename;</span></span></code></pre></div></li></ol><h2 id="database-maintenance-tips" tabindex="-1">Database Maintenance Tips <a class="header-anchor" href="#database-maintenance-tips" aria-label="Permalink to &quot;Database Maintenance Tips&quot;">​</a></h2><h3 id="regular-backups" tabindex="-1">Regular Backups <a class="header-anchor" href="#regular-backups" aria-label="Permalink to &quot;Regular Backups&quot;">​</a></h3><ul><li>Daily automated backups</li><li>Test restoration procedures</li><li>Store backups off-site</li><li>Keep multiple versions</li></ul><h3 id="monitoring" tabindex="-1">Monitoring <a class="header-anchor" href="#monitoring" aria-label="Permalink to &quot;Monitoring&quot;">​</a></h3><ul><li>Watch table growth rates</li><li>Monitor slow queries</li><li>Check error logs</li><li>Track connection counts</li></ul><h3 id="optimization" tabindex="-1">Optimization <a class="header-anchor" href="#optimization" aria-label="Permalink to &quot;Optimization&quot;">​</a></h3><ul><li>Run OPTIMIZE TABLE monthly</li><li>Review and add indexes</li><li>Archive old data</li><li>Clean up orphaned records</li></ul><h3 id="security" tabindex="-1">Security <a class="header-anchor" href="#security" aria-label="Permalink to &quot;Security&quot;">​</a></h3><ul><li>Use strong database passwords</li><li>Restrict database user permissions</li><li>Change default table prefix</li><li>Keep database server updated</li><li>Disable remote access if not needed</li></ul><h2 id="next-steps" tabindex="-1">Next Steps <a class="header-anchor" href="#next-steps" aria-label="Permalink to &quot;Next Steps&quot;">​</a></h2><ul><li><a href="./security">Security Checks</a> - Evaluate security settings</li><li><a href="./performance">Performance Checks</a> - Optimize database performance</li><li><a href="./system">System Checks</a> - Review hosting environment</li></ul>`,106))])}const y=i(p,[["render",c]]);export{E as __pageData,y as default};
